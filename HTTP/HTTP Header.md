## HTTP Header



### 1. HTTP 헤더 개요

- 메시지 본문을 통해 표현 데이터 전달
- 메시지 본문 = 페이로드(payload)
- 표현은 요청이나 응답에서 전달할 실제 데이터
- 표현 헤더는 표현 데이터를 해석할 수 있는 정보 제공
  - 데이터 유형(HTML, json), 데이터 길이, 압축 정보 등등



### 2. 표현

- Content-Type: 표현 데이터의 형식
- Content-Encoding: 표현 데이터의 압축 방식
- Content-Language: 표현 데이터의 자연 언어를 표현
- Content-Length: 표현 데이터의 길이(바이트 단위)



### 3. 협상(Content - negotiation)

클라이언트가 선호하는 언어, 표현 요청

- Accept: 클라이언트가 선호하는 미디어 타입 전달
- Accept-Charset: 클라이언트가 선호하는 문자 인코딩
- Accept-Encoding: 클라이언트가 선호하는 압축 인코딩
- Accept-Language: 클라이언트가 선호하는 자연 언어
- Quality Values(q): 요청하는 표현이 없을 경우 우선순위가 높은것으로 응답. 0~1, 클수록 높은 우선순위, 구체적인 것이 우선



### 4. 전송 방식

- 단순 전송(Content-Length): 한 번에 요청하고 한 번에 쭉 받는 것
- 압축 전송(Content-Encoding): 무엇으로 압축 되어있는지의 정보
- 분할 전송(Transfer-Encoding): 용량이 큰 것을 분할해서 보내 오는대로 표현을 취하는 것, 이것은 Content-Length를 넣으면 안된다.
- 범위 전송(Range, Content-Range): 범위를 정해주어 요청 받는 것



### 5. 일반 정보

- From: 유저 에이전트의 이메일 정보
- Referer: 이전 웹 페이지 주소
  - Referer를 사용해서 유입 경로 분석 가능, 요청에서 사용
- User-Agent: 유저 에이전트 애플리케이션 정보, 클라이언트의 애플리케이션 정보, 통계 정보, 장애 파악 가능
- Server: 요청을 처리하는 origin 서버의 소프트웨어 정보
- Date: 메시지가 발생한 날짜와 시간, 응답에서 사용



### 6. 특별한 정보

- Host: 요청한 호스트 정보(도메인), 요청에서 사용, 필수

- Location: 페이지 리다이렉션, 웹 브라우저는 3xx 응답의 결과에 Location 헤더가 있으면, Location 위치로 자동 이동(리다이렉트)
- Allow: 허용 가능한 HTTP 메서드, 405에서 응답에 포함시켜서 보내주어야한다. -> 참고용
- Retry-After: 유저 에이전트가 다음 요청을 하기까지 기다려야 하는 시간



### 7. 인증

- Authorization: 클라이언트 인증 정보를 서버에 전달
- WWW-Authenticate: 리소스 접근시 필요한 인증 방법 정의
  - 리소스 접근시 필요한 인증 방법 정의



### 8. 쿠키

- Set-Cookie: 서버에서 클라이언트로 쿠키 전달(응답)

- Cookie: 클라이언트가 서버에서 받은 쿠키를 저장하고, HTTP 요청시 서버로 전달

- 요청하기전에 모든 쿠키정보를 탐색하여 찾은 뒤 해당 정보가 있으면 보낸다.

- 사용처

  - 사용자 로그인 세션 관리
  - 광고 정보 트래킹

- 쿠키 정보는 항상 서버에 전송

  - 네트워크 트래픽 추가 유발

  - 최소한의 정보만 사용

  - 서버에 전송하지 않고, 웹 브라우저 내부에 데이터를 저장하고 싶으면 웹 스토리지(LocalStorage, sessionStorage)

    -> 쿠키와 Localstroage의 차이는 서버에 데이터를 보내는 여부의 차이

- 생명주기: expires을 넣어서 만료일이 되면 쿠키 삭제

  - 세션 쿠키: 만료 날짜를 생략하면 브라우저 종료시 까지만 유지
  - 영속 쿠키: 만료 날짜를 입력하면 해당 날짜까지 유지

- 도메인 접근

  - 명시: 명시한 문서 기준 도메인 + 서브 도메인 포함
  - 생략: 현재 문서 기준 도메인만 적용

- 경로

  - 이 경로를 포함한 하위 경로 페이지만 쿠키 접근
  - 일반적으로 path=/루트로 지정

- 보안

  - Secure: 쿠키는 http, https 구분없이 전송하지만, Secure 적용시 https인 경우에만 전송
  - HttpOnly: XSS 공격 방지, 자바스크립트에서 접근 불가, HTTP 전송에만 사용
  - SameSite: XSRF 공격 방지, 브라우저에서 지원하는지 확인 여부가 필요하다.